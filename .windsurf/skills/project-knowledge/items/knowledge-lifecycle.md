# 知識生命週期管理

> 定義知識分類、觸發更新條件、過時判定標準與維護流程

## 知識分類

### 按更新頻率分類

| 類別 | 說明 | 位置 | 更新頻率 |
|------|------|------|----------|
| **通用框架** | 可跨專案複用的規範 | `.windsurf/skills/` | 罕見 |
| **專案架構** | 與代碼強關聯的結構描述 | `items/architecture.md` | 即時同步 |
| **專案模組** | 功能模組清單 | `items/modules.md` | 定期 |
| **業務邏輯** | 專案特定業務規則 | `.memory/context/` | 按需 |
| **歷史歸檔** | 已完成的任務記錄 | `.memory/archive/` | 歸檔時 |

### 內容歸屬判定

```
問：這個內容放哪裡？

├─ 可跨專案複用？
│  ├─ YES → .windsurf/skills/
│  └─ NO → 繼續判斷
│
├─ 是業務規則/流程？
│  ├─ YES → .memory/context/
│  └─ NO → 繼續判斷
│
├─ 是歷史記錄/歸檔？
│  ├─ YES → .memory/archive/
│  └─ NO → 可能不需要記錄
```

## 觸發更新條件

### 即時觸發

| 觸發事件 | 影響文件 | 更新內容 |
|----------|----------|----------|
| 新增 `app/pages/` 文件 | `architecture.md` | 頁面結構 |
| 新增 `app/components/` 目錄 | `architecture.md` | 組件結構 |
| 新增 `server/routes/` 端點 | `modules.md`、`api-mapping.md` | API 清單 |
| 修改 `prisma/schema.prisma` | `architecture.md` | 資料模型 |

### 定期觸發

| 觸發條件 | 頻率 | 動作 |
|----------|------|------|
| OpenSpec 歸檔 | 每次 | 記錄維護日誌 |
| 技術決策變更 | 即時 | 更新 `tech-decisions.md` |
| 30 天未維護 | 月度 | 提示人工檢查 |

## 過時判定標準

| 判定維度 | 過時標準 | 檢測方式 |
|----------|----------|----------|
| 結構差異 | 文件描述的目錄不存在 | `scripts/sync-check.sh` |
| 數量偏差 | 頁面/組件數量偏差 > 20% | 手動比對 |
| 時間過期 | 超過 30 天未更新 | 維護日誌 |

## 維護流程 SOP

### 新增知識

1. 判斷內容歸屬（通用 vs 專案特定）
2. 在對應位置建立文件
3. 記錄到 `maintenance-log.md`

### 更新知識

1. 確認需要更新的文件
2. 對照實際代碼更新內容
3. 確保格式一致
4. 記錄到 `maintenance-log.md`

### 刪除/歸檔知識

1. 確認內容已過時或不再需要
2. 若有歷史價值：移至 `.memory/archive/`
3. 若無價值：直接刪除
4. 記錄到 `maintenance-log.md`

## AI 行為指引

AI 應主動識別以下情況並提示：

```markdown
- 「架構文件可能過時，建議更新」
- 「發現新模組，建議添加到 modules.md」
- 「發現新業務規則，建議添加到 .memory/context/」
- 「此變更建議記錄到維護日誌」
```
